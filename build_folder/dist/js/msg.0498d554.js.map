{"version":3,"sources":["webpack:///./src/components/top.vue","webpack:///./src/components/top.vue?b7e4","webpack:///./src/themeCommon/user/msg.vue?a70c","webpack:///./src/components/top.vue?c98e","webpack:///./src/themeCommon/user/msg.vue","webpack:///./src/themeCommon/user/msg.vue?8444"],"names":["class","href","back","title","showCenter","$t","$route","meta","rightAction","rightClick","name","props","type","Object","Boolean","default","backHandler","Function","leftIcon","String","setup","emit","attrs","router","onBack","onRightClick","render","__scopeId","center","active-color","$style","primary","options","changeType","right","show","pageLoading","list","length","description","image","loading","onRefresh","error","isError","error-text","errorTip","finished","finished-text","onLoad","item","index","key","computeHtmlTime","content","formatTime","createTime","components","Top","store","useScope","t","tm","state","current","customInfo","_user","customerInfo","val","console","log","getMsgList","parentType","then","res","check","data","records","concat","size","total","catch","err","returnVal","reg","tag","match","forEach","replace","matchStr","time","toString","timeStr","dayjs","Number","format","gotMsg","document","body","addEventListener","removeEventListener"],"mappings":"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","file":"js/msg.0498d554.js","sourcesContent":["<template>\r\n    <div class='top'>\r\n        <slot name='left'>\r\n            <a class='back' href='javascript:;' @click='back'>\r\n                <span class='icon_icon_back'></span>\r\n            </a>\r\n        </slot>\r\n        <slot name='center'>\r\n            <div v-if='title' class='title'>\r\n                {{ title }}\r\n            </div>\r\n            <div v-else-if='showCenter' class='title'>\r\n                {{ $t($route.meta.title) }}\r\n            </div>\r\n        </slot>\r\n        <slot name='tabs'></slot>\r\n        <slot name='right'>\r\n            <a v-if='rightAction.title' class='rightClick' href='javascript:;' @click='rightClick'>\r\n                <span class='right-text'>\r\n                    {{ rightAction.title }}\r\n                </span>\r\n                <van-icon name='arrow' />\r\n            </a>\r\n        </slot>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { useRouter } from 'vue-router'\r\nexport default {\r\n    props: {\r\n        rightAction: {\r\n            type: [Object, Boolean],\r\n            default: function () {\r\n                return { title: '' }\r\n            }\r\n        },\r\n        backHandler: Function,\r\n        leftIcon: {\r\n            type: String,\r\n            default: 'arrow-left'\r\n        },\r\n        title: {\r\n            type: String,\r\n            default: ''\r\n        },\r\n        showCenter: {\r\n            type: Boolean,\r\n            default: false\r\n        }\r\n    },\r\n    setup (props, { emit, attrs }) {\r\n        const router = useRouter()\r\n        // 点击返回\r\n        const back = () => {\r\n            attrs.onBack ? emit('back') : router.back()\r\n        }\r\n        // 点击右侧按钮\r\n        const rightClick = () => {\r\n            attrs.onRightClick && emit('rightClick')\r\n        }\r\n        return {\r\n            back,\r\n            rightClick,\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '@/sass/mixin.scss';\r\n.top {\r\n    display: flex;\r\n    flex-shrink: 0;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    height: rem(100px);\r\n    font-size: rem(34px);\r\n    background: var(--contentColor);\r\n    .back {\r\n        position: absolute;\r\n        top: rem(26px);\r\n        left: 0;\r\n        z-index: 1;\r\n        padding: 0 rem(30px);\r\n        color: var(--color);\r\n    }\r\n    .rightClick {\r\n        position: absolute;\r\n        right: rem(30px);\r\n        display: flex;\r\n        align-items: center;\r\n        height: rem(60px);\r\n        padding: 0 0 0 rem(26px);\r\n        color: var(--color);\r\n        font-size: rem(24px);\r\n        border: 1px solid var(--bdColor);\r\n        border-radius: rem(30px);\r\n    }\r\n    .van-icon-arrow {\r\n        margin-right: rem(10px);\r\n        margin-left: rem(5px);\r\n        font-weight: bold;\r\n        vertical-align: middle;\r\n    }\r\n    .right-text {\r\n        vertical-align: middle;\r\n    }\r\n    .title {\r\n        width: 60%;\r\n        max-width: 60%;\r\n        margin: 0 auto;\r\n        color: var(--color);\r\n        font-size: rem(34px);\r\n        line-height: rem(59px);\r\n        text-align: center;\r\n    }\r\n}\r\n</style>\r\n","import { render } from \"./top.vue?vue&type=template&id=5326f10a&scoped=true\"\nimport script from \"./top.vue?vue&type=script&lang=js\"\nexport * from \"./top.vue?vue&type=script&lang=js\"\n\nimport \"./top.vue?vue&type=style&index=0&id=5326f10a&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-5326f10a\"\n\nexport default script","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./msg.vue?vue&type=style&index=0&id=e88bb8d4&lang=scss&scoped=true\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./top.vue?vue&type=style&index=0&id=5326f10a&lang=scss&scoped=true\"","<template>\r\n    <Top class='msgTopBar'>\r\n        <template #center>\r\n            <div class='msgTopCenter'>\r\n                <van-dropdown-menu :active-color='$style.primary'>\r\n                    <van-dropdown-item v-model='type' :options='options' @change='changeType' />\r\n                </van-dropdown-menu>\r\n            </div>\r\n        </template>\r\n        <template #right>\r\n            <div class='right-ico'>\r\n                <i class='icon icon_quanbuyidu'></i>\r\n            </div>\r\n        </template>\r\n    </Top>\r\n    <Loading :show='pageLoading' />\r\n    <div class='msg-list'>\r\n        <div v-if='list.length === 0'>\r\n            <van-empty :description='$t(\"common.noData\")' image='/images/empty.png' />\r\n        </div>\r\n        <van-pull-refresh v-else v-model='loading' @refresh='onRefresh'>\r\n            <van-list\r\n                v-model:error='isError'\r\n                v-model:loading='loading'\r\n                :error-text='errorTip'\r\n                :finished='finished'\r\n                :finished-text='$t(\"common.noMore\")'\r\n                @load='onLoad'\r\n            >\r\n                <div v-for='(item,index) in list' :key='index' class='msg-item'>\r\n                    <p class='msg-title'>\r\n                        {{ item.title === 'null'? '': item.title }}\r\n                    </p>\r\n                    <p class='msg-content'>\r\n                        {{ computeHtmlTime(item.content) }}\r\n                    </p>\r\n                    <p class='msg-time'>\r\n                        {{ formatTime(item.createTime) }}\r\n                    </p>\r\n                </div>\r\n            </van-list>\r\n        </van-pull-refresh>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport { onBeforeMount, computed, reactive, toRefs, onUnmounted } from 'vue'\r\nimport { queryPlatFormMessageLogList } from '@/api/user'\r\nimport { useStore } from 'vuex'\r\nimport dayjs from 'dayjs'\r\nimport Top from '@/components/top'\r\nimport { isEmpty } from '@/utils/util'\r\nimport { useI18n } from 'vue-i18n'\r\nexport default {\r\n    components: {\r\n        Top,\r\n    },\r\n    setup (props) {\r\n        const store = useStore()\r\n        const { t, tm } = useI18n({ useScope: 'global' })\r\n        const state = reactive({\r\n            list: [],\r\n            loading: false,\r\n            finished: false,\r\n            pageLoading: false,\r\n            current: 1,\r\n            type: '',\r\n            errorTip: '',\r\n            rightAction: { title: 444 },\r\n            options: tm('msg.typesOptions')\r\n        })\r\n        const isError = computed(() => !!state.isError)\r\n\r\n        // 获取账户信息\r\n        const customInfo = computed(() => store.state._user.customerInfo)\r\n\r\n        const changeType = (val) => {\r\n            console.log(val)\r\n            state.type = val\r\n            state.current = 1\r\n            state.finished = false\r\n            state.list = []\r\n            getMsgList()\r\n        }\r\n\r\n        const getMsgList = () => {\r\n            state.pageLoading = true\r\n            state.errorTip = ''\r\n            queryPlatFormMessageLogList({\r\n                current: state.current,\r\n                parentType: state.type,\r\n            }).then(res => {\r\n                state.loading = false\r\n                state.pageLoading = false\r\n                if (res.check()) {\r\n                    if (res.data.records && res.data.records.length > 0) {\r\n                        state.list = state.list.concat(res.data.records)\r\n                    }\r\n\r\n                    // 数据全部加载完成\r\n                    if (res.data.size * res.data.current >= res.data.total) {\r\n                        state.finished = true\r\n                    }\r\n                }\r\n            }).catch(err => {\r\n                state.errorTip = t('c.loadError')\r\n                state.pageLoading = false\r\n            })\r\n        }\r\n\r\n        const computeHtmlTime = (content) => {\r\n            try {\r\n                const reg = /<?time[^>]*>[^<]*<\\/time>/gi\r\n                const tag = content.match(reg)\r\n                let returnVal\r\n                if (!isEmpty(tag) && tag.length > 0) {\r\n                    tag.forEach(item => {\r\n                        returnVal = content.replace(reg, function (matchStr) {\r\n                            const time = matchStr.toString().replace(/<\\/?time>/g, '')\r\n                            const timeStr = dayjs(Number(time)).format('YYYY-MM-DD HH:mm:ss')\r\n                            return timeStr\r\n                        })\r\n                    })\r\n                    return returnVal\r\n                } else {\r\n                    return content\r\n                }\r\n            } catch (error) {\r\n                console.log(error)\r\n            }\r\n        }\r\n\r\n        // 获取到顶部消息通知，同时刷新消息列表\r\n        const gotMsg = () => {\r\n            onRefresh()\r\n        }\r\n        document.body.addEventListener('GotMsg_notice', gotMsg, false)\r\n        onBeforeMount(() => {\r\n            getMsgList()\r\n        })\r\n        onUnmounted(() => {\r\n            document.body.removeEventListener('GotMsg_notice', gotMsg)\r\n        })\r\n\r\n        // 上拉刷新\r\n        const onRefresh = () => {\r\n            state.current = 1\r\n            state.finished = false\r\n            state.list = []\r\n            getMsgList()\r\n        }\r\n        // 底部加载更多\r\n        const onLoad = () => {\r\n            state.current++\r\n            getMsgList()\r\n        }\r\n\r\n        const formatTime = (val) => {\r\n            return dayjs(val).format('YYYY-MM-DD HH:mm:ss')\r\n        }\r\n\r\n        return {\r\n            getMsgList,\r\n            isError,\r\n            customInfo,\r\n            formatTime,\r\n            onRefresh,\r\n            onLoad,\r\n            changeType,\r\n            computeHtmlTime,\r\n            ...toRefs(state)\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '@/sass/mixin.scss';\r\n.right-ico {\r\n    position: absolute;\r\n    right: rem(30px);\r\n    color: var(--contentColor);\r\n    font-size: rem(48px);\r\n}\r\n.msgTopCenter {\r\n    flex: 1;\r\n}\r\n.msg-list {\r\n    flex: 1;\r\n    height: 100%;\r\n    overflow: auto;\r\n    background-color: var(--bgColor);\r\n    .msg-item {\r\n        margin: rem(15px);\r\n        padding: rem(20px);\r\n        background-color: var(--contentColor);\r\n        border-top: solid rem(20px) var(--bgColor);\r\n        .msg-title {\r\n            color: var(--color);\r\n            font-weight: bold;\r\n            font-size: rem(28px);\r\n            line-height: rem(60px);\r\n        }\r\n        .msg-content {\r\n            color: var(--color);\r\n            font-weight: 500;\r\n            font-size: rem(24px);\r\n            line-height: rem(40px);\r\n        }\r\n        .msg-time {\r\n            color: var(--minorColor);\r\n            font-weight: 400;\r\n            font-size: rem(20px);\r\n            line-height: rem(60px);\r\n        }\r\n    }\r\n}\r\n.msgTopBar {\r\n    position: relative !important;\r\n    background-color: var(--contentColor);\r\n    :deep(.van-dropdown-menu__bar) {\r\n        background-color: var(--contentColor);\r\n        .van-dropdown-menu__title {\r\n            color: var(--color);\r\n        }\r\n    }\r\n    :deep(.van-dropdown-item__content) {\r\n        .van-cell {\r\n            background-color: var(--contentColor);\r\n            .van-cell__title {\r\n                color: var(--color);\r\n            }\r\n        }\r\n    }\r\n}\r\n</style>\r\n","import { render } from \"./msg.vue?vue&type=template&id=e88bb8d4&scoped=true\"\nimport script from \"./msg.vue?vue&type=script&lang=js\"\nexport * from \"./msg.vue?vue&type=script&lang=js\"\n\nimport \"./msg.vue?vue&type=style&index=0&id=e88bb8d4&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-e88bb8d4\"\n\nexport default script"],"sourceRoot":""}