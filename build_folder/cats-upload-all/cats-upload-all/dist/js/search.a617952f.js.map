{"version":3,"sources":["webpack:///./src/themes/cats/views/search/search.vue?0b1b","webpack:///./src/themes/cats/views/search/resultItem.vue?3deb","webpack:///./src/themes/cats/views/search/search.vue","webpack:///./src/themes/cats/views/search/resultItem.vue","webpack:///./src/themes/cats/views/search/resultItem.vue?b8cd","webpack:///./src/themes/cats/views/search/search.vue?60f6"],"names":["class","keywords","updateVal","background","$style","contentColor","placeholder","$t","show-action","onSearch","action","onCancel","localRecord","item","key","sourceId","product","resultList","toProduct","symbolName","symbolCode","$store","state","_user","customerInfo","inSelfSymbolList","toggleSelfimg","toggleSelf","$event","props","setup","store","router","list","getters","userSelfSymbolList","find","el","symbolId","modifyOptional","localList","JSON","parse","indexOf","push","stringify","name","query","value","dispatch","then","res","catch","err","render","__scopeId","components","ResultItem","productMap","_quote","map","id","filter","val","onClear","customerGroupId","check","data","history","back"],"mappings":"mIAAA,W,kCCAA,W,8JCCSA,MAAM,iB,SAeeA,MAAM,gB,GACnBA,MAAM,S,GAKVA,MAAM,c,0IArBf,eAwBM,MAxBN,EAwBM,CAvBF,eAaa,G,WAZA,EAAAC,S,sDAAA,EAAAA,SAAQ,IAKI,EAAAC,WAJpBC,WAAY,EAAAC,OAAOC,aACnBC,YAAa,EAAAC,GAAE,sBAChBC,cAAA,GACC,SAAQ,EAAAC,U,CAGEC,OAAM,GACb,iBAEM,CAFN,eAEM,OAFDV,MAAM,qBAAsB,QAAK,8BAAE,EAAAW,UAAA,EAAAA,SAAA,sB,eACjC,EAAAJ,GAAE,2B,mFAIL,EAAAN,S,wCAAZ,eAKM,MALN,EAKM,CAJF,eAEM,MAFN,EAEM,eADC,EAAAM,GAAE,uB,mBAET,eAA+E,2BAApD,EAAAK,aAAW,SAAnBC,G,wBAAnB,eAA+E,GAAtCC,IAAKD,EAAKE,SAAWC,QAASH,G,gCAE3E,eAEM,MAFN,EAEM,E,mBADF,eAA8E,2BAAnD,EAAAI,YAAU,SAAlBJ,G,wBAAnB,eAA8E,GAAtCC,IAAKD,EAAKE,SAAWC,QAASH,G,oJCtBzEb,MAAM,oB,GAEEA,MAAM,Q,GAGNA,MAAM,S,GACDA,MAAM,e,SAKwBA,MAAM,Y,wEAXtD,eAkBM,MAlBN,EAkBM,CAjBF,eASM,OATDA,MAAM,UAAW,QAAK,8BAAE,EAAAkB,WAAA,EAAAA,UAAA,sB,CACzB,eAEM,MAFN,EAEM,CADF,eAAqC,2BAA5B,EAAAF,QAAQG,YAAU,KAE/B,eAIM,MAJN,EAIM,CAHF,eAEO,OAFP,EAEO,eADA,EAAAH,QAAQI,YAAU,OAItB,EAAAC,OAAOC,MAAMC,MAAMC,c,iBAA9B,eAMM,MANN,EAMM,CALF,eAIK,KAHDxB,MAAK,CAAC,eAAc,cACK,EAAAyB,iBAAgB,QAAY,EAAAC,gBACpD,QAAK,+CAAO,EAAAC,WAAW,EAAAX,QAASY,KAAM,Y,gGAWxC,GACXC,MAAO,CAAC,WACRC,MAFW,SAEJD,GACH,IAAME,EAAQ,iBACRC,EAAS,iBACTV,EAAQ,eAAS,CACnBI,eAAe,IAEbD,EAAmB,gBAAS,WAC9B,IAAMQ,EAAOF,EAAMG,QAAQC,oBAAsB,GACjD,OAAOF,EAAKG,MAAK,SAAAC,GAAC,OAAKA,EAAGC,WAAaT,EAAMb,QAAQsB,eAEnDX,EAAa,WACfY,KAIErB,EAAY,WACd,IAAMoB,EAAWT,EAAMb,QAAQsB,SACzBE,EAAYC,KAAKC,MAAM,eAAS,oBAAsB,IACvB,IAAjCF,EAAUG,QAAQL,IAAkBE,EAAUI,KAAKN,GACvD,eAAS,iBAAkBG,KAAKI,UAAUL,IAC1CR,EAAOY,KAAK,CAAEE,KAAM,UAAWC,MAAO,CAAET,eAItCC,EAAiB,WACnBjB,EAAMI,eAAgB,EACtB,IAAMhB,EAASe,EAAiBuB,MAAQ,gCAAkC,6BAC1EjB,EAAMkB,SAASvC,EAAQ,CAACmB,EAAMb,QAAQsB,WAAWY,MAAK,SAAAC,GAClD7B,EAAMI,eAAgB,KACvB0B,OAAM,SAAAC,GACL/B,EAAMI,eAAgB,MAG9B,wCACO,eAAOJ,IADd,IAEIG,mBACAE,aACAT,YACAqB,qB,UC9DZ,EAAOe,OAAS,EAChB,EAAOC,UAAY,kBAEJ,Q,YF0BA,GACXC,WAAY,CACRC,WAAA,GAEJ3B,MAJW,WAKP,IAAMC,EAAQ,iBACR2B,EAAa,gBAAS,kBAAM3B,EAAMT,MAAMqC,OAAOD,cAC/CpC,EAAQ,eAAS,CACnBrB,SAAU,GACVuC,UAAWC,KAAKC,MAAM,eAAS,oBAAsB,GACrDzB,WAAY,KAEVL,EAAc,gBAAS,kBAAMU,EAAMkB,UAAUoB,KAAI,SAAAC,GAAC,OAAKH,EAAWV,MAAMa,MAAKC,QAAO,SAAAzB,GAAC,OAAKA,QAC1FnC,EAAY,SAAC6D,GACftD,EAASsD,IAGPC,EAAU,WACZ1C,EAAML,WAAa,IAGjBR,EAAW,gBAAS,SAACK,GACvB,IAAKA,EAAK,OAAO,EACjB,eAAc,CAAEgC,KAAMhC,EAAKmD,gBAAiBlC,EAAMG,QAAQ+B,kBAAmBf,MAAK,SAAAC,GAC9E,GAAIA,EAAIe,QAAS,CACb,IAAIjC,EAAOkB,EAAIgB,MAAQ,GACvBlC,EAAOA,EAAK2B,KAAI,SAAAvB,GAAC,OAAKqB,EAAWV,MAAMX,EAAGwB,OAAKC,QAAO,SAAAzB,GAAC,QAAOA,KAC9Df,EAAML,WAAagB,SAKzBtB,EAAW,WACbyD,QAAQC,QAEZ,wCACO,eAAO/C,IADd,IAEIV,cACAV,YACA8D,UACAvD,WACAE,e,UGtEZ,EAAO2C,OAASA,EAChB,EAAOC,UAAY,kBAEJ","file":"js/search.a617952f.js","sourcesContent":["export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./search.vue?vue&type=style&index=0&id=2d8632b5&lang=scss&scoped=true\"","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./resultItem.vue?vue&type=style&index=0&id=15a7a827&lang=scss&scoped=true\"","<template>\r\n    <div class='searchWrapper'>\r\n        <van-search\r\n            v-model='keywords'\r\n            :background='$style.contentColor'\r\n            :placeholder=\"$t('search.placeholder')\"\r\n            show-action\r\n            @search='onSearch'\r\n            @update:model-value='updateVal'\r\n        >\r\n            <template #action>\r\n                <div class='van-search__action' @click='onCancel'>\r\n                    {{ $t('compLang.cancel') }}\r\n                </div>\r\n            </template>\r\n        </van-search>\r\n        <div v-if='!keywords' class='searchRecord'>\r\n            <div class='label'>\r\n                {{ $t('search.lastest') }}\r\n            </div>\r\n            <ResultItem v-for='item in localRecord' :key='item.sourceId' :product='item' />\r\n        </div>\r\n        <div class='searchBody'>\r\n            <ResultItem v-for='item in resultList' :key='item.sourceId' :product='item' />\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { reactive, toRefs, computed } from 'vue'\r\nimport ResultItem from './resultItem.vue'\r\nimport { useStore } from 'vuex'\r\nimport { getSymbolList } from '@/api/trade'\r\nimport { localGet, debounce } from '@/utils/util'\r\nexport default {\r\n    components: {\r\n        ResultItem,\r\n    },\r\n    setup () {\r\n        const store = useStore()\r\n        const productMap = computed(() => store.state._quote.productMap)\r\n        const state = reactive({\r\n            keywords: '',\r\n            localList: JSON.parse(localGet('searchProducts')) || [],\r\n            resultList: []\r\n        })\r\n        const localRecord = computed(() => state.localList.map(id => productMap.value[id]).filter(el => el))\r\n        const updateVal = (val) => {\r\n            onSearch(val)\r\n        }\r\n        // 清楚搜索\r\n        const onClear = () => {\r\n            state.resultList = []\r\n        }\r\n        // 搜索\r\n        const onSearch = debounce((key) => {\r\n            if (!key) return false\r\n            getSymbolList({ name: key, customerGroupId: store.getters.customerGroupId }).then(res => {\r\n                if (res.check()) {\r\n                    let list = res.data || []\r\n                    list = list.map(el => productMap.value[el.id]).filter(el => !!el)\r\n                    state.resultList = list\r\n                }\r\n            })\r\n        })\r\n        // 返回\r\n        const onCancel = () => {\r\n            history.back()\r\n        }\r\n        return {\r\n            ...toRefs(state),\r\n            localRecord,\r\n            updateVal,\r\n            onClear,\r\n            onSearch,\r\n            onCancel,\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '@/sass/mixin.scss';\r\n.searchWrapper {\r\n    height: 100%;\r\n    background: var(--contentColor);\r\n    .searchBody {\r\n        background: var(--contentColor);\r\n    }\r\n    .searchRecord {\r\n        background: var(--contentColor);\r\n        .label {\r\n            padding: rem(20px) rem(30px);\r\n            color: var(--minorColor);\r\n            font-size: rem(26px);\r\n            line-height: rem(36px);\r\n        }\r\n    }\r\n}\r\n</style>\r\n","<template>\r\n    <div class='searchResultItem'>\r\n        <div class='product' @click='toProduct'>\r\n            <div class='name'>\r\n                <span>{{ product.symbolName }}</span>\r\n            </div>\r\n            <div class='block'>\r\n                <span class='symbol-code'>\r\n                    {{ product.symbolCode }}\r\n                </span>\r\n            </div>\r\n        </div>\r\n        <div v-if='$store.state._user.customerInfo' class='optional'>\r\n            <i\r\n                class='icon_zixuan1'\r\n                :class=\"{ 'icon_zixuan2':inSelfSymbolList, 'loading':toggleSelfimg }\"\r\n                @click.stop='toggleSelf(product, $event)'\r\n            ></i>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { computed, reactive, toRefs } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { useRouter } from 'vue-router'\r\nimport { localGet, localSet } from '@/utils/util'\r\nexport default {\r\n    props: ['product'],\r\n    setup (props) {\r\n        const store = useStore()\r\n        const router = useRouter()\r\n        const state = reactive({\r\n            toggleSelfimg: false\r\n        })\r\n        const inSelfSymbolList = computed(() => {\r\n            const list = store.getters.userSelfSymbolList || []\r\n            return list.find(el => el.symbolId === props.product.symbolId)\r\n        })\r\n        const toggleSelf = () => {\r\n            modifyOptional()\r\n        }\r\n\r\n        // 进入产品详情\r\n        const toProduct = () => {\r\n            const symbolId = props.product.symbolId\r\n            const localList = JSON.parse(localGet('searchProducts')) || []\r\n            if (localList.indexOf(symbolId) === -1) localList.push(symbolId)\r\n            localSet('searchProducts', JSON.stringify(localList))\r\n            router.push({ name: 'Product', query: { symbolId } })\r\n        }\r\n\r\n        // 添加/删除自选\r\n        const modifyOptional = () => {\r\n            state.toggleSelfimg = true\r\n            const action = inSelfSymbolList.value ? '_user/removeCustomerOptionals' : '_user/addCustomerOptionals'\r\n            store.dispatch(action, [props.product.symbolId]).then(res => {\r\n                state.toggleSelfimg = false\r\n            }).catch(err => {\r\n                state.toggleSelfimg = false\r\n            })\r\n        }\r\n        return {\r\n            ...toRefs(state),\r\n            inSelfSymbolList,\r\n            toggleSelf,\r\n            toProduct,\r\n            modifyOptional,\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '@/sass/mixin.scss';\r\n.searchResultItem {\r\n    display: flex;\r\n    align-items: center;\r\n    height: rem(124px);\r\n    padding: 0 rem(32px);\r\n    line-height: 1.3;\r\n    border-bottom: 1px solid var(--lineColor);\r\n    &:hover {\r\n        background-color: var(--bgColor);\r\n    }\r\n    .product {\r\n        flex: 1;\r\n    }\r\n    .name {\r\n        color: var(--color);\r\n        font-size: rem(34px);\r\n        line-height: rem(36px);\r\n    }\r\n    .block {\r\n        padding-top: 3px;\r\n        color: var(--minorColor);\r\n        font-size: rem(20px);\r\n        line-height: rem(36px);\r\n    }\r\n    .optional {\r\n        width: rem(48px);\r\n        height: rem(124px);\r\n        color: var(--minorColor);\r\n        font-size: rem(33px);\r\n        line-height: rem(124px);\r\n        .icon_zixuan2 {\r\n            color: var(--focusColor);\r\n        }\r\n        .loading {\r\n            position: relative;\r\n            &::before {\r\n                position: absolute;\r\n                animation: loading 0.6s linear infinite;\r\n            }\r\n        }\r\n        .zoomIn {\r\n            position: relative;\r\n            &::before {\r\n                position: absolute;\r\n                animation: zoomIn 0.6s linear forwards;\r\n            }\r\n        }\r\n    }\r\n}\r\n</style>\r\n","import { render } from \"./resultItem.vue?vue&type=template&id=15a7a827&scoped=true\"\nimport script from \"./resultItem.vue?vue&type=script&lang=js\"\nexport * from \"./resultItem.vue?vue&type=script&lang=js\"\n\nimport \"./resultItem.vue?vue&type=style&index=0&id=15a7a827&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-15a7a827\"\n\nexport default script","import { render } from \"./search.vue?vue&type=template&id=2d8632b5&scoped=true\"\nimport script from \"./search.vue?vue&type=script&lang=js\"\nexport * from \"./search.vue?vue&type=script&lang=js\"\n\nimport \"./search.vue?vue&type=style&index=0&id=2d8632b5&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-2d8632b5\"\n\nexport default script"],"sourceRoot":""}