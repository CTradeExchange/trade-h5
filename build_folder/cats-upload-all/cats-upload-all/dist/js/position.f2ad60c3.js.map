{"version":3,"sources":["webpack:///./src/themes/mt4/views/position/position.vue","webpack:///./src/themes/mt4/views/position/position.vue?224a","webpack:///./src/themes/mt4/components/capitalList.vue?2d44","webpack:///./src/themes/mt4/views/position/position.vue?c200","webpack:///./src/themes/mt4/components/capitalList.vue","webpack:///./src/themes/mt4/components/capitalList.vue?b9cf"],"names":["class","right","href","sortActionsVisible","newOrder","data","capitalListData","positionList","length","$store","state","_trade","positionLoading","type","pendingList","description","$t","refresh","show","actions","sortActions","cancel-text","actionSheetOnSelect","components","CapitalList","PositionList","PendingList","Top","setup","store","router","useScope","t","sortActionsSelected","_user","customerInfo","name","feild","className","sortActionValue","accountInfo","accountAssets","title","value","balance","netWorth","availableMargin","occupyMargin","isNaN","marginRadio","item","forEach","el","queryList","dispatch","then","res","check","subscribList","concat","map","symbolId","send_subscribe","queryPendingList","push","query","_quote","productActivedID","render","__scopeId","key","valKey","titleKey","props","String","default","Array"],"mappings":"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","file":"js/position.f2ad60c3.js","sourcesContent":["<template>\r\n    <Top>\r\n        <template #right>\r\n            <a class='icon icon_paixu' href='javascript:;' @click='sortActionsVisible=true'></a>\r\n            <a class='icon icon_xindingdan' href='javascript:;' @click='newOrder'></a>\r\n        </template>\r\n    </Top>\r\n    <div class='container'>\r\n        <CapitalList :data='capitalListData' />\r\n        <div v-if='positionList.length===0 && $store.state._trade.positionLoading' class='loading'>\r\n            <van-loading type='spinner' />\r\n        </div>\r\n        <van-empty v-else-if='positionList.length===0 && pendingList.length===0' :description=\"$t('emptyHistory')\" />\r\n        <div v-if='positionList.length' class='titleBar'>\r\n            {{ $t('position.price') }}\r\n        </div>\r\n        <PositionList v-if='positionList.length' @refresh='refresh' />\r\n        <template v-if='pendingList.length'>\r\n            <div class='titleBar'>\r\n                {{ $t('history.order') }}\r\n            </div>\r\n            <PendingList @refresh='refresh' />\r\n        </template>\r\n    </div>\r\n\r\n    <!-- 排序 actionsheet -->\r\n    <van-action-sheet v-model:show='sortActionsVisible' :actions='sortActions' :cancel-text=\"$t('cancel')\" @select='actionSheetOnSelect' />\r\n</template>\r\n\r\n<script>\r\nimport Top from '@m/layout/top'\r\nimport CapitalList from '@m/components/capitalList'\r\nimport PositionList from '@m/modules/positionList/positionList'\r\nimport PendingList from '@m/modules/pendingList/pendingList'\r\nimport { reactive, toRefs, computed, onMounted, watch, onUpdated } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { QuoteSocket } from '@/plugins/socket/socket'\r\nimport { useRouter } from 'vue-router'\r\nimport { priceFormat, isEmpty } from '@/utils/util'\r\nimport { mul } from '@/utils/calculation'\r\nimport { useI18n } from 'vue-i18n'\r\nexport default {\r\n    components: {\r\n        CapitalList,\r\n        PositionList,\r\n        PendingList,\r\n        Top,\r\n    },\r\n    setup () {\r\n        const store = useStore()\r\n        const router = useRouter()\r\n        const { t } = useI18n({ useScope: 'global' })\r\n        const positionList = computed(() => store.state._trade.positionList)\r\n        const pendingList = computed(() => store.state._trade.pendingList)\r\n        const customerInfo = computed(() => store.state._user.customerInfo)\r\n        const sortActionsSelected = 'van-badge__wrapper van-icon van-icon-down'\r\n        const sortActions = [\r\n            { name: t('history.order'), feild: 'orderId', className: sortActionsSelected },\r\n            { name: t('history.daytime'), feild: 'openTime', },\r\n            { name: t('history.product'), feild: 'symbolId', },\r\n            // { name: '利润', feild: 'yz', },\r\n        ]\r\n        let sortActionValue = sortActions[0].feild\r\n\r\n        const accountInfo = computed(() => store.state._user.accountAssets)\r\n        const capitalListData = computed(() => {\r\n            return [\r\n                { title: t('history.lirun') + t('colon'), value: !isEmpty(accountInfo.value) ? accountInfo.value.balance : '--' },\r\n                { title: t('trade.jingzhi') + t('colon'), value: !isEmpty(accountInfo.value) ? accountInfo.value.netWorth : '--' },\r\n                { title: t('trade.usableAdvance') + t('colon'), value: !isEmpty(accountInfo.value) ? accountInfo.value.availableMargin : '--' },\r\n                { title: t('trade.advance') + t('colon'), value: !isEmpty(accountInfo.value) ? accountInfo.value.occupyMargin : '--' },\r\n                { title: t('trade.advanceRatio') + '(%)' + t('colon'), value: isNaN(accountInfo.value.marginRadio) ? '--' : accountInfo.value.marginRadio + '%' },\r\n            ]\r\n        })\r\n\r\n        const state = reactive({\r\n            sortActionsVisible: false,\r\n            sortActions\r\n        })\r\n        const actionSheetOnSelect = item => {\r\n            sortActions.forEach(el => (el.className = ''))\r\n            item.className = sortActionsSelected\r\n            sortActionValue = item.feild\r\n            state.sortActionsVisible = false\r\n            queryList()\r\n        }\r\n        // 查询持仓列表\r\n        const queryList = () => {\r\n            store.dispatch('_trade/queryPositionPage', { 'sortFieldName': sortActionValue, 'sortType': 'desc' }).then(res => {\r\n                if (res.check()) {\r\n                    const subscribList = positionList.value.concat(pendingList.value).map(el => el.symbolId)\r\n                    QuoteSocket.send_subscribe(subscribList)\r\n                }\r\n            })\r\n        }\r\n        const queryPendingList = () => {\r\n            store.dispatch('_trade/queryPBOOrderPage', { 'sortFieldName': sortActionValue, 'sortType': 'desc' }).then(res => {\r\n                if (res.check()) {\r\n                    const subscribList = positionList.value.concat(pendingList.value).map(el => el.symbolId)\r\n                    QuoteSocket.send_subscribe(subscribList)\r\n                }\r\n            })\r\n        }\r\n        queryList()\r\n        queryPendingList()\r\n\r\n        const newOrder = () => {\r\n            router.push({ name: 'Order', query: { symbolId: store.state._quote.productActivedID } })\r\n        }\r\n        // 刷新持仓列表\r\n        const refresh = () => {\r\n            queryList()\r\n        }\r\n\r\n        return {\r\n            ...toRefs(state),\r\n            pendingList,\r\n            actionSheetOnSelect,\r\n            newOrder,\r\n            refresh,\r\n            accountInfo,\r\n            capitalListData,\r\n            positionList\r\n        }\r\n    },\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '~@/sass/mixin.scss';\r\n.loading {\r\n    padding-top: 30%;\r\n    text-align: center;\r\n}\r\n.container {\r\n    flex: 1;\r\n    margin-bottom: rem(100px);\r\n    overflow-y: auto;\r\n}\r\n.titleBar {\r\n    height: rem(60px);\r\n    padding: 0 rem(40px);\r\n    font-size: rem(28px);\r\n    line-height: rem(60px);\r\n    background: var(--bgColor);\r\n    border: 1px solid rgba($color: #000, $alpha: 0.1);\r\n    border-width: 1px 0;\r\n    box-shadow: 0 1px 0 rgba($color: #FFF, $alpha: 1) inset;\r\n}\r\n.icon {\r\n    color: var(--white);\r\n    font-size: 1.4em;\r\n    &:not(:first-of-type) {\r\n        margin-left: 0.6em;\r\n    }\r\n}\r\n:deep(.van-icon-down) {\r\n    &::before {\r\n        content: '';\r\n    }\r\n    &::after {\r\n        display: inline-block;\r\n        margin-left: 5px;\r\n        vertical-align: -2px;\r\n        content: '\\F04B';\r\n    }\r\n}\r\n</style>\r\n","import { render } from \"./position.vue?vue&type=template&id=7aa10990&scoped=true\"\nimport script from \"./position.vue?vue&type=script&lang=js\"\nexport * from \"./position.vue?vue&type=script&lang=js\"\n\nimport \"./position.vue?vue&type=style&index=0&id=7aa10990&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-7aa10990\"\n\nexport default script","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./capitalList.vue?vue&type=style&index=0&id=5d44de12&lang=scss&scoped=true\"","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./position.vue?vue&type=style&index=0&id=7aa10990&lang=scss&scoped=true\"","<template>\r\n    <ul class='capitalList'>\r\n        <li v-for='item in data' :key='item[valKey]' class='item'>\r\n            <span class='title'>\r\n                {{ item[titleKey] }}\r\n            </span>\r\n            <span class='value'>\r\n                {{ item[valKey] }}\r\n            </span>\r\n        </li>\r\n    </ul>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    props: {\r\n        titleKey: {\r\n            type: String,\r\n            default: 'title'\r\n        },\r\n        valKey: {\r\n            type: String,\r\n            default: 'value'\r\n        },\r\n        data: {\r\n            type: Array,\r\n            default: []\r\n        },\r\n    },\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '~@/sass/mixin.scss';\r\n.capitalList {\r\n    padding: rem(20px) rem(30px);\r\n    font-size: rem(24px);\r\n    .item {\r\n        position: relative;\r\n        display: flex;\r\n        justify-content: space-between;\r\n        height: rem(50px);\r\n        line-height: rem(50px);\r\n        &::before {\r\n            position: absolute;\r\n            top: 48%;\r\n            left: 0;\r\n            width: 100%;\r\n            height: 1px;\r\n            border-bottom: 1px dashed var(--placeholder);\r\n            content: '';\r\n        }\r\n        .title,\r\n        .value {\r\n            position: relative;\r\n            z-index: 1;\r\n            padding: 0 rem(10px);\r\n            background: #FFF;\r\n        }\r\n        .value {\r\n            color: var(--primary);\r\n            font-weight: bold;\r\n        }\r\n    }\r\n}\r\n</style>\r\n","import { render } from \"./capitalList.vue?vue&type=template&id=5d44de12&scoped=true\"\nimport script from \"./capitalList.vue?vue&type=script&lang=js\"\nexport * from \"./capitalList.vue?vue&type=script&lang=js\"\n\nimport \"./capitalList.vue?vue&type=style&index=0&id=5d44de12&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-5d44de12\"\n\nexport default script"],"sourceRoot":""}