{"version":3,"sources":["webpack:///./src/themeCommon/user/msg.vue?e293","webpack:///./src/themeCommon/user/msg.vue","webpack:///./src/themeCommon/user/msg.vue?50b3","webpack:///./src/themeCommon/user/msg.vue?3f5f"],"names":["class","back","menu","title","title-vis","center","active-color","type","options","changeType","right","show","pageLoading","list","length","description","$t","image","loading","onRefresh","finished","finished-text","onLoad","item","index","key","computeHtmlTime","content","formatTime","createTime","setup","props","store","useScope","tm","t","state","current","rightAction","customInfo","_user","customerInfo","val","console","log","getMsgList","parentType","then","res","check","data","records","concat","size","total","catch","err","returnVal","reg","tag","match","forEach","replace","matchStr","time","toString","timeStr","dayjs","Number","format","error","render","__scopeId"],"mappings":"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","file":"js/msg.2abb8376.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./msg.vue?vue&type=style&index=0&id=2fce3d5e&lang=scss&scoped=true\"","<template>\r\n    <LayoutTop :back='true' :menu='false' title='' :title-vis='false'>\r\n        <template #center>\r\n            <div>\r\n                <van-dropdown-menu active-color='#007AFF'>\r\n                    <van-dropdown-item v-model='type' :options='options' @change='changeType' />\r\n                </van-dropdown-menu>\r\n            </div>\r\n        </template>\r\n        <template #right>\r\n            <div class='right-ico'>\r\n                <i class='icon icon_quanbuyidu'></i>\r\n            </div>\r\n        </template>\r\n    </LayoutTop>\r\n    <Loading :show='pageLoading' />\r\n    <div class='msg-list'>\r\n        <div v-if='list.length === 0'>\r\n            <van-empty :description='$t(\"common.noData\")' image='search' />\r\n        </div>\r\n        <van-pull-refresh v-else v-model='loading' @refresh='onRefresh'>\r\n            <van-list\r\n                v-model:loading='loading'\r\n                :finished='finished'\r\n                :finished-text='$t(\"common.noMore\")'\r\n                @load='onLoad'\r\n            >\r\n                <div v-for='(item,index) in list' :key='index' class='msg-item'>\r\n                    <p class='msg-title'>\r\n                        {{ item.title === 'null'? '': item.title }}\r\n                    </p>\r\n                    <p class='msg-content'>\r\n                        {{ computeHtmlTime(item.content) }}\r\n                    </p>\r\n                    <p class='msg-time'>\r\n                        {{ formatTime(item.createTime) }}\r\n                    </p>\r\n                </div>\r\n            </van-list>\r\n        </van-pull-refresh>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport { onBeforeMount, computed, reactive, toRefs } from 'vue'\r\nimport { queryPlatFormMessageLogList } from '@/api/user'\r\nimport { useStore } from 'vuex'\r\nimport dayjs from 'dayjs'\r\nimport { Toast } from 'vant'\r\nimport { isEmpty } from '@/utils/util'\r\nimport { useI18n } from 'vue-i18n'\r\nexport default {\r\n    setup (props) {\r\n        const store = useStore()\r\n        const { t, tm } = useI18n({ useScope: 'global' })\r\n        const state = reactive({\r\n            list: [],\r\n            loading: false,\r\n            finished: false,\r\n            pageLoading: false,\r\n            current: 1,\r\n            type: '',\r\n            rightAction: { title: 444 },\r\n            options: tm('msg.typesOptions')\r\n        })\r\n\r\n        // 获取账户信息\r\n        const customInfo = computed(() => store.state._user.customerInfo)\r\n\r\n        const changeType = (val) => {\r\n            console.log(val)\r\n            state.type = val\r\n            state.current = 1\r\n            state.finished = false\r\n            state.list = []\r\n            getMsgList()\r\n        }\r\n\r\n        const getMsgList = () => {\r\n            state.pageLoading = true\r\n            queryPlatFormMessageLogList({\r\n                current: state.current,\r\n                parentType: state.type,\r\n            }).then(res => {\r\n                state.loading = false\r\n                state.pageLoading = false\r\n                if (res.check()) {\r\n                    if (res.data.records && res.data.records.length > 0) {\r\n                        state.list = state.list.concat(res.data.records)\r\n                    }\r\n\r\n                    // 数据全部加载完成\r\n                    if (res.data.size * res.data.current >= res.data.total) {\r\n                        state.finished = true\r\n                    }\r\n                }\r\n            }).catch(err => {\r\n                state.pageLoading = false\r\n            })\r\n        }\r\n\r\n        const computeHtmlTime = (content) => {\r\n            try {\r\n                const reg = /<?time[^>]*>[^<]*<\\/time>/gi\r\n                const tag = content.match(reg)\r\n                let returnVal\r\n                if (!isEmpty(tag) && tag.length > 0) {\r\n                    tag.forEach(item => {\r\n                        returnVal = content.replace(reg, function (matchStr) {\r\n                            const time = matchStr.toString().replace(/<\\/?time>/g, '')\r\n                            const timeStr = dayjs(Number(time)).format('YYYY-MM-DD HH:mm:ss')\r\n                            return timeStr\r\n                        })\r\n                    })\r\n                    return returnVal\r\n                } else {\r\n                    return content\r\n                }\r\n            } catch (error) {\r\n                console.log(error)\r\n            }\r\n        }\r\n\r\n        onBeforeMount(() => {\r\n            getMsgList()\r\n        })\r\n\r\n        // 上拉刷新\r\n        const onRefresh = () => {\r\n            state.current = 1\r\n            state.finished = false\r\n            state.list = []\r\n            getMsgList()\r\n        }\r\n        // 底部加载更多\r\n        const onLoad = () => {\r\n            state.current++\r\n            getMsgList()\r\n        }\r\n\r\n        const formatTime = (val) => {\r\n            return dayjs(val).format('YYYY-MM-DD HH:mm:ss')\r\n        }\r\n\r\n        return {\r\n            getMsgList,\r\n            customInfo,\r\n            formatTime,\r\n            onRefresh,\r\n            onLoad,\r\n            changeType,\r\n            computeHtmlTime,\r\n            ...toRefs(state)\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '@/sass/mixin.scss';\r\n.right-ico {\r\n    position: absolute;\r\n    right: rem(30px);\r\n    color: var(--white);\r\n    font-size: rem(48px);\r\n}\r\n.msg-list {\r\n    flex: 1;\r\n    height: 100%;\r\n    overflow: auto;\r\n    .msg-item {\r\n        padding: rem(30px);\r\n        border-top: solid rem(20px) var(--btnColor);\r\n        .msg-title {\r\n            color: var(--color);\r\n            font-weight: bold;\r\n            font-size: rem(28px);\r\n            line-height: rem(60px);\r\n        }\r\n        .msg-content {\r\n            color: var(--color);\r\n            font-weight: 500;\r\n            font-size: rem(24px);\r\n            line-height: rem(40px);\r\n        }\r\n        .msg-time {\r\n            color: var(--mutedColor);\r\n            font-weight: 400;\r\n            font-size: rem(20px);\r\n            line-height: rem(60px);\r\n        }\r\n    }\r\n}\r\n</style>\r\n\r\n<style lang=\"scss\">\r\n@import '@/sass/mixin.scss';\r\n.van-dropdown-menu__bar {\r\n    background-color: transparent !important;\r\n    .van-dropdown-menu__title {\r\n        color: var(--white);\r\n    }\r\n    .van-ellipsis {\r\n        color: var(--white);\r\n    }\r\n}\r\n</style>\r\n","import { render } from \"./msg.vue?vue&type=template&id=2fce3d5e&scoped=true\"\nimport script from \"./msg.vue?vue&type=script&lang=js\"\nexport * from \"./msg.vue?vue&type=script&lang=js\"\n\nimport \"./msg.vue?vue&type=style&index=0&id=2fce3d5e&lang=scss&scoped=true\"\nimport \"./msg.vue?vue&type=style&index=1&id=2fce3d5e&lang=scss\"\nscript.render = render\nscript.__scopeId = \"data-v-2fce3d5e\"\n\nexport default script","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./msg.vue?vue&type=style&index=1&id=2fce3d5e&lang=scss\""],"sourceRoot":""}